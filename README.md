# Excel Watchdog - 智慧型 Excel 檔案監控與變更分析工具

這是一個高效能、高可靠性的 Excel 檔案監控工具，專為需要追蹤重要 Excel 檔案（特別是包含複雜公式和外部參照的檔案）變更的團隊和個人設計。

## 核心功能

- **即時檔案監控**: 自動監控指定資料夾內的所有 Excel 檔案 (`.xlsx`, `.xlsm`) 的新增與修改事件。
- **智慧變更分析**: 不僅僅是比較檔案的修改時間，更能深入到儲存格層級，精準識別**有意義的變更**，包括：
    - **直接值變更**: 手動輸入的數值或文字改變。
    - **公式變更**: 儲存格內的公式結構發生變化。
    - **外部參照更新**: 公式未變，但因外部連結檔案刷新而導致結果改變。
- **高效能讀取引擎**: 結合 `openpyxl`（讀取公式）與 `Polars` / `XML`（高速讀取值），在保證準確性的前提下，大幅提升大型檔案的解析速度。
- **圖形化設定介面**: 提供一個詳細且友善的圖形化介面 (GUI) 來調整數十項專業參數，從監控範圍到效能策略，無需修改程式碼。
- **穩健的複製與快取**: 在讀取網路檔案前，會先將其複製到本地快取，並採用多種穩定性檢查與重試機制（支援 `robocopy`），最大限度地避免因網路不穩或檔案鎖定造成的問題。
- **清晰的差異報告**: 在偵測到變更時，於主控台輸出一個對齊良好、支援中文的「三欄式」比較表格，清晰展示變更前後的內容。
- **彈性的壓縮與歸檔**: 基準線 (Baseline) 檔案支援 `lz4`, `zstd`, `gzip` 多種壓縮格式，並可設定自動歸檔策略，平衡效能與儲存空間。

## 系統需求

- **作業系統**: Windows (因使用了 `robocopy`, `powershell` 等 Windows 特定功能)
- **Python 版本**: Python 3.9+

## 安裝指南

1.  **複製專案**:
    ```bash
    git clone <your-repo-url>
    cd watchdog_1
    ```

2.  **安裝依賴套件**:
    建議在虛擬環境中執行。
    ```bash
    pip install -r requirements.txt
    ```

## 快速入門

1.  **執行主程式**:
    ```bash
    python main.py
    ```

2.  **首次設定**:
    - 程式啟動時會彈出「Excel Watchdog 設定」視窗。
    - **最重要的一步**: 在「監控範圍與啟動掃描」分頁中，點擊「監控資料夾」旁邊的「新增」按鈕，選擇你想要監控的資料夾。
    - **建議設定**: 在「日誌與輸出」分頁中，確認 `LOG_FOLDER` 和 `CACHE_FOLDER` 指向一個你有權限讀寫的本機路徑。
    - 點擊右下角的「儲存並開始」。

3.  **開始監控**:
    - 程式會首先掃描你設定的資料夾，為所有找到的 Excel 檔案建立「基準線」。
    - 建立完成後，程式會進入即時監控模式。當你修改並儲存任何受監控的 Excel 檔案時，主控台將會輸出變更報告。

## 專案架構概覽

- **/config**: 存放靜態設定 (`settings.py`) 和動態執行動態設定 (`runtime.py`)。
- **/core**: 包含應用程式的核心商業邏輯，如基準線管理 (`baseline.py`)、檔案比較 (`comparison.py`)、Excel 解析 (`excel_parser.py`) 和檔案監控 (`watcher.py`)。
- **/ui**: 使用者介面相關模組，包括主控台視窗 (`console.py`) 和圖形化設定介面 (`settings_ui.py`)。
- **/utils**: 提供各種輔助工具，如快取管理 (`cache.py`)、壓縮 (`compression.py`)、日誌 (`logging.py`) 等。
- **main.py**: 程式的進入點。

## 授權

(請在此處填寫你的授權資訊，例如：MIT License)
